# ✅ 真机测试检查清单

## 🔧 环境准备

### 电脑端
- [x] 获取电脑 IP 地址：`192.168.18.2`
- [x] 修改 API 配置文件
- [x] 重新构建 APK
- [x] APK 已生成：`app-release.apk` (21.54 MB)

### 手机端
- [ ] 启用 USB 调试
  - 设置 → 开发者选项 → USB 调试（打开）
- [ ] 用 USB 线连接电脑
- [ ] 手机和电脑在同一 WiFi 网络
  - 手机 WiFi：`192.168.18.x` 网段
  - 电脑 IP：`192.168.18.2`

---

## 📲 安装步骤

### 步骤 1：检查设备连接
```powershell
adb devices
```
- [ ] 设备已连接
- [ ] 显示设备序列号

### 步骤 2：卸载旧应用
```powershell
adb uninstall com.example.frontend
```
- [ ] 旧应用已卸载

### 步骤 3：安装新 APK
```powershell
cd D:\JZ_Project3
adb install -r app-release.apk
```
- [ ] 安装成功
- [ ] 显示 "Success"

### 步骤 4：启动应用
```powershell
adb shell am start -n com.example.frontend/.MainActivity
```
- [ ] 应用已启动
- [ ] 应用界面已显示

---

## 🧪 功能测试

### 后端服务
- [ ] 启动后端服务
  ```powershell
  cd backend
  .\venv\Scripts\python.exe -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
  ```
- [ ] 后端运行在 `http://192.168.18.2:8000`
- [ ] 可以访问 `http://192.168.18.2:8000/docs`

### 应用连接测试
- [ ] 打开应用
- [ ] 应用界面正常显示
- [ ] 没有连接错误提示

### 注册功能测试
- [ ] 点击"注册"按钮
- [ ] 填写用户信息
  - [ ] 用户名：`test`
  - [ ] 邮箱：`test@example.com`
  - [ ] 密码：`password123`
  - [ ] 确认密码：`password123`
- [ ] 点击"注册"按钮
- [ ] **预期结果：** ✅ 注册成功，无错误提示

### 登录功能测试
- [ ] 点击"登录"按钮
- [ ] 填写登录信息
  - [ ] 邮箱：`test@example.com`
  - [ ] 密码：`password123`
- [ ] 点击"登录"按钮
- [ ] **预期结果：** ✅ 登录成功

### 其他功能测试
- [ ] 查看用户资料
- [ ] 修改用户信息
- [ ] 测试生成功能
- [ ] 查看历史记录

---

## 🔍 故障排除

### 问题 1：仍然显示 localhost 错误
- [ ] 卸载旧应用
- [ ] 重新安装新 APK
- [ ] 清除应用缓存
  ```powershell
  adb shell pm clear com.example.frontend
  ```

### 问题 2：无法连接到 192.168.18.2:8000
- [ ] 检查手机 WiFi 连接
- [ ] 检查电脑 IP 地址
  ```powershell
  ipconfig
  ```
- [ ] 检查后端服务是否运行
- [ ] 检查防火墙设置

### 问题 3：防火墙阻止连接
- [ ] 打开 Windows Defender 防火墙
- [ ] 允许 Python 通过防火墙
- [ ] 允许 FastAPI 通过防火墙

### 问题 4：设备无法识别
- [ ] 检查 USB 线连接
- [ ] 启用 USB 调试
- [ ] 重启 ADB 服务
  ```powershell
  adb kill-server
  adb start-server
  ```

---

## 📊 测试结果记录

### 环境信息
- 电脑 IP：`192.168.18.2`
- 后端端口：`8000`
- APK 版本：`21.54 MB`
- 构建时间：`2025-11-04 19:54:15`

### 测试日期
- 测试日期：`_____________`
- 测试人员：`_____________`
- 测试设备：`_____________`

### 测试结果
- [ ] 所有测试通过
- [ ] 部分测试失败（请说明）
- [ ] 所有功能正常

### 备注
```
_________________________________________________________________

_________________________________________________________________

_________________________________________________________________
```

---

## 📝 常见问题

### Q: 为什么要使用 IP 地址而不是 localhost？
**A:** 在真机上，`localhost` 指的是手机本身，而不是电脑。使用 IP 地址可以让真机访问电脑上的服务。

### Q: 如果 IP 地址不是 192.168.18.2 怎么办？
**A:** 
1. 查看你的 IP：`ipconfig`
2. 修改配置文件中的 IP 地址
3. 重新构建 APK

### Q: 模拟器还能用吗？
**A:** 可以，但需要特殊配置。模拟器中使用 `10.0.2.2` 指向主机的 localhost。

### Q: 如何验证后端是否运行？
**A:** 在浏览器中打开 `http://192.168.18.2:8000/docs`

---

## ✨ 成功标志

当你看到以下情况时，说明配置成功：

✅ 应用成功连接到后端
✅ 注册/登录功能正常
✅ 没有 `localhost` 连接错误
✅ 可以查看用户信息
✅ 可以使用所有功能

---

**祝你测试顺利！** 🚀

